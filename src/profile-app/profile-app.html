
<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<dom-module id="profile-app">
  <template>
    <style>
      :host {
        display: block;
      }
      .icon {
        height: 32px;
        width: 32px;
      }
      .icon-link {
        text-decoration: none !important;
      }
    </style>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <br/>
    <div class="profile">
      <div class="card text-center border-dark mx-auto" style="width: 90%;">
        <img class="card-img-top" style="height:150px; object-fit: cover;" 
        src="{{profile.background}}" />
        <div style="height: 100px;">
          <img style="position: relative; top: -100px;" class="mx-auto d-block rounded-circle border border-dark" src="./images/0.jpeg" />
        </div>
        <div class="card-body">
          <h3 class="card-title">{{data.name}}</h3>
          <h5 class="card-subtitle mb-2 text-muted">{{data.career}} - {{data.id}}</h5>
          <h5 class="card-subtitle mb-2 text-muted">
            <a id="mail" href="#" title="{{messages.copied}}">{{data.email}}</a>
          </h5>
        </div>
        <div class="card-footer">
          <a class="icon-link" href="{{data.linkedin}}">
            <img class="icon" src="{{icons.linkedin}}" />
          </a>
          <a class="icon-link" href="{{data.github}}">
            <img class="icon" src="{{icons.github}}" />
          </a>
        </div>
      </div>
      <br/>
      <div class="card mx-auto border-light" style="width: 90%;">
        <h5>{{messages.projectsTitle}}</h5>
        <table class="table table-hover table-striped">
          <thead>
            <tr>
              <th>{{messages.projectsColumnName}}:</th>
              <th>{{messages.projectsColumnTools}}:</th>
            </tr>
          </thead>
          <tbody>
            <template is="dom-repeat" as="repository" items="{{data.repositories}}">
              <tr>
                <!-- <th scope="row"></th> -->
                <td>
                  <a href="{{repository.url}}">{{repository.name}}</a>
                </td>
                <td>
                  <div class="tools">
                    {{repository.toolsGroup}}
                    <!-- {{JSON.stringify(tool)}} -->
                    <!-- 
                    {{tool.join(',')}}
                    <template is="dom-repeat" as="tool" items="{{repository.tools}}">
                      {{tool}}
                    </template> -->
                  </div>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </template>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
  <script>
    /**
     * @customElement
     * @polymer
     */
    class ProfileApp extends Polymer.Element {
      static get is() { return 'profile-app'; }
      static get properties() {
        return {
          messages: {
            type: Object,
            value: {
              copied: 'Copied!',
              projectsTitle: 'Repository projects',
              projectsColumnName: 'Name',
              projectsColumnTools: 'Tools'
            }
          },
          profile: {
            type: Object,
            value: {
              background: 'https://i.imgur.com/OUrEY8F.jpg'
            }
          },
          icons: {
            type: Object,
            value: {
              linkedin: 'https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.5.6/collection/build/ionicons/svg/logo-linkedin.svg',
              github: 'https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.5.6/collection/build/ionicons/svg/logo-github.svg',
            }
          },
          data: {
            type: Object,
            observer: '_changeData',
            value: {
              career: 'Ingeniería en informática',
              id: '11687330',
              name: 'Francisco Javier Castañeda Martínez',
              email: 'xavierxmac@gmail.com',
              linkedin: 'https://www.linkedin.com/in/francisco-javier-casta%C3%B1eda-mart%C3%ADnez-878936127/',
              github: 'https://github.com/donxd',
              image: 'https://media.licdn.com/dms/image/C4E03AQFYmoE7jsArGg/profile-displayphoto-shrink_200_200/0?e=1573689600&v=beta&t=yUuOx7H1RFYyOO7Y6_afUACZYsjc4X6fR-ddrgXdD_o',
              repositories: [
                {
                  name: 'celex-list-element',
                  url: 'https://github.com/donxd/celex-list-element',
                  tools: ['polymer', 'html', 'js', 'css']
                },
                {
                  name: 'celex-api',
                  url: 'https://github.com/donxd/celex-api',
                  tools: ['node', 'js', 'loopback', 'mysql']
                },
                {
                  name: 'celex-crawler',
                  url: 'https://github.com/donxd/celex-crawler',
                  tools: ['node', 'js', 'mysql']
                },
                {
                  name: 'cf-scripts',
                  url: 'https://github.com/donxd/cs-test-scripts-organise',
                  tools: ['bash','git']
                },
                {
                  name: 'poly-frogs',
                  url: 'https://github.com/donxd/poly-frogs',
                  tools: ['polymer', 'html', 'js', 'css']
                },
                {
                  name: 'basic-node-service',
                  url: 'https://github.com/donxd/basic-node-service',
                  tools: ['node', 'express', 'js']
                },
                {
                  name: 'basic-kube',
                  url: 'https://github.com/donxd/basic-kube',
                  tools: ['kubernetes', 'docker', 'node', 'express']
                },
                {
                  name: 'mods-saes',
                  url: 'https://github.com/donxd/mods-saes',
                  tools: ['js', 'html', 'css']
                },
                {
                  name: 'mods-saes-mobile',
                  url: 'https://github.com/donxd/mods-saes-mobile',
                  tools: ['js', 'html', 'css']
                },
                {
                  name: 'reportes-ss-ipn',
                  url: 'https://github.com/donxd/reportes-ss-ipn',
                  tools: ['php', 'js', 'html', 'css', 'word', 'excel']
                },
                {
                  name: 'js-poo',
                  url: 'https://github.com/donxd/js-poo-test-es',
                  tools: ['js']
                },
                {
                  name: 'cs-arcade-intro-001',
                  url: 'https://github.com/donxd/cs-arcade-intro-001',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-002',
                  url: 'https://github.com/donxd/cs-arcade-intro-002',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-003',
                  url: 'https://github.com/donxd/cs-arcade-intro-003',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-004',
                  url: 'https://github.com/donxd/cs-arcade-intro-004',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-005',
                  url: 'https://github.com/donxd/cs-arcade-intro-005',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-006',
                  url: 'https://github.com/donxd/cs-arcade-intro-006',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-007',
                  url: 'https://github.com/donxd/cs-arcade-intro-007',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-008',
                  url: 'https://github.com/donxd/cs-arcade-intro-008',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-009',
                  url: 'https://github.com/donxd/cs-arcade-intro-009',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-010',
                  url: 'https://github.com/donxd/cs-arcade-intro-010',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-011',
                  url: 'https://github.com/donxd/cs-arcade-intro-011',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-012',
                  url: 'https://github.com/donxd/cs-arcade-intro-012',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-013',
                  url: 'https://github.com/donxd/cs-arcade-intro-013',
                  tools: ['js']
                },
                {
                  name: 'cs-arcade-intro-014',
                  url: 'https://github.com/donxd/cs-arcade-intro-014',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-015',
                  url: 'https://github.com/donxd/cs-arcade-intro-015',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-016',
                  url: 'https://github.com/donxd/cs-arcade-intro-016',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-017',
                  url: 'https://github.com/donxd/cs-arcade-intro-017',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-018',
                  url: 'https://github.com/donxd/cs-arcade-intro-018',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-019',
                  url: 'https://github.com/donxd/cs-arcade-intro-019',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-020',
                  url: 'https://github.com/donxd/cs-arcade-intro-020',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-021',
                  url: 'https://github.com/donxd/cs-arcade-intro-021',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-022',
                  url: 'https://github.com/donxd/cs-arcade-intro-022',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-023',
                  url: 'https://github.com/donxd/cs-arcade-intro-023',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-024',
                  url: 'https://github.com/donxd/cs-arcade-intro-024',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-025',
                  url: 'https://github.com/donxd/cs-arcade-intro-025',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-026',
                  url: 'https://github.com/donxd/cs-arcade-intro-026',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-027',
                  url: 'https://github.com/donxd/cs-arcade-intro-027',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-028',
                  url: 'https://github.com/donxd/cs-arcade-intro-028',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-029',
                  url: 'https://github.com/donxd/cs-arcade-intro-029',
                  tools: ['java']
                },
                {
                  name: 'cs-arcade-intro-030',
                  url: 'https://github.com/donxd/cs-arcade-intro-030',
                  tools: ['java']
                }
              ]
            }
          }
        };
      }
      _changeData (newData, oldData) {
        this._prepareData(newData);
      }
      _prepareData (data) {
        if (data && data.repositories) {
          $(this.$.mail).tooltip({trigger: 'manual', placement: 'right'});
          for (let x of data.repositories) {
            x.toolsGroup = this._prepareTools(x.tools);
          }
          const copyMail = new ClipboardJS(this.$.mail, {
            text: trigger => {
              $(this.$.mail).tooltip('show');
              setTimeout(() => $(this.$.mail).tooltip('hide'), 1500);
              return this.data.email;
            }
          });
        }
      }
      _prepareTools (tools) {
        return tools.join(', ');
      }
    }

    window.customElements.define(ProfileApp.is, ProfileApp);
  </script>
</dom-module>
